(()=>{"use strict";var t={659:(t,e,r)=>{r.r(e),r.d(e,{glMatrix:()=>n,mat2:()=>i,mat2d:()=>a,mat3:()=>s,mat4:()=>o,quat:()=>c,quat2:()=>l,vec2:()=>f,vec3:()=>u,vec4:()=>h});var n={};r.r(n),r.d(n,{ARRAY_TYPE:()=>M,EPSILON:()=>d,RANDOM:()=>p,equals:()=>b,setMatrixArrayType:()=>m,toRadian:()=>x});var i={};r.r(i),r.d(i,{LDU:()=>V,add:()=>C,adjoint:()=>A,clone:()=>_,copy:()=>T,create:()=>g,determinant:()=>R,equals:()=>F,exactEquals:()=>O,frob:()=>D,fromRotation:()=>j,fromScaling:()=>S,fromValues:()=>P,identity:()=>y,invert:()=>L,mul:()=>W,multiply:()=>U,multiplyScalar:()=>X,multiplyScalarAndAdd:()=>N,rotate:()=>B,scale:()=>I,set:()=>w,str:()=>G,sub:()=>Y,subtract:()=>q,transpose:()=>E});var a={};r.r(a),r.d(a,{add:()=>ht,clone:()=>z,copy:()=>H,create:()=>Z,determinant:()=>J,equals:()=>Mt,exactEquals:()=>dt,frob:()=>ut,fromRotation:()=>it,fromScaling:()=>at,fromTranslation:()=>st,fromValues:()=>K,identity:()=>k,invert:()=>$,mul:()=>pt,multiply:()=>tt,multiplyScalar:()=>lt,multiplyScalarAndAdd:()=>ft,rotate:()=>et,scale:()=>rt,set:()=>Q,str:()=>ot,sub:()=>mt,subtract:()=>ct,translate:()=>nt});var s={};r.r(s),r.d(s,{add:()=>Ft,adjoint:()=>Et,clone:()=>bt,copy:()=>gt,create:()=>vt,determinant:()=>Lt,equals:()=>Zt,exactEquals:()=>Yt,frob:()=>Ot,fromMat2d:()=>Gt,fromMat4:()=>xt,fromQuat:()=>Dt,fromRotation:()=>jt,fromScaling:()=>St,fromTranslation:()=>It,fromValues:()=>_t,identity:()=>yt,invert:()=>wt,mul:()=>zt,multiply:()=>At,multiplyScalar:()=>Nt,multiplyScalarAndAdd:()=>Wt,normalFromMat4:()=>Vt,projection:()=>Ct,rotate:()=>Ut,scale:()=>Bt,set:()=>Tt,str:()=>qt,sub:()=>Ht,subtract:()=>Xt,translate:()=>Rt,transpose:()=>Pt});var o={};r.r(o),r.d(o,{add:()=>Ce,adjoint:()=>ne,clone:()=>Kt,copy:()=>Qt,create:()=>kt,determinant:()=>ie,equals:()=>Ne,exactEquals:()=>Xe,frob:()=>Ve,fromQuat:()=>we,fromQuat2:()=>be,fromRotation:()=>Me,fromRotationTranslation:()=>xe,fromRotationTranslationScale:()=>ye,fromRotationTranslationScaleOrigin:()=>Pe,fromScaling:()=>de,fromTranslation:()=>fe,fromValues:()=>$t,fromXRotation:()=>pe,fromYRotation:()=>me,fromZRotation:()=>ve,frustum:()=>Ee,getRotation:()=>Te,getScaling:()=>_e,getTranslation:()=>ge,identity:()=>te,invert:()=>re,lookAt:()=>Se,mul:()=>We,multiply:()=>ae,multiplyScalar:()=>Oe,multiplyScalarAndAdd:()=>Fe,ortho:()=>Ie,orthoNO:()=>Be,orthoZO:()=>je,perspective:()=>Ae,perspectiveFromFieldOfView:()=>Ue,perspectiveNO:()=>Le,perspectiveZO:()=>Re,rotate:()=>ue,rotateX:()=>he,rotateY:()=>ce,rotateZ:()=>le,scale:()=>oe,set:()=>Jt,str:()=>De,sub:()=>Ye,subtract:()=>qe,targetTo:()=>Ge,translate:()=>se,transpose:()=>ee});var u={};r.r(u),r.d(u,{add:()=>$e,angle:()=>Lr,bezier:()=>br,ceil:()=>rr,clone:()=>ze,copy:()=>Ke,create:()=>Ze,cross:()=>mr,dist:()=>Dr,distance:()=>hr,div:()=>Gr,divide:()=>er,dot:()=>pr,equals:()=>Br,exactEquals:()=>Ur,floor:()=>nr,forEach:()=>Or,fromValues:()=>ke,hermite:()=>xr,inverse:()=>dr,len:()=>Cr,length:()=>He,lerp:()=>vr,max:()=>ar,min:()=>ir,mul:()=>Sr,multiply:()=>tr,negate:()=>fr,normalize:()=>Mr,random:()=>gr,rotateX:()=>Pr,rotateY:()=>wr,rotateZ:()=>Er,round:()=>sr,scale:()=>or,scaleAndAdd:()=>ur,set:()=>Qe,sqrDist:()=>Vr,sqrLen:()=>qr,squaredDistance:()=>cr,squaredLength:()=>lr,str:()=>Rr,sub:()=>jr,subtract:()=>Je,transformMat3:()=>Tr,transformMat4:()=>_r,transformQuat:()=>yr,zero:()=>Ar});var h={};r.r(h),r.d(h,{add:()=>Zr,ceil:()=>Kr,clone:()=>Xr,copy:()=>Wr,create:()=>Fr,cross:()=>fn,dist:()=>Pn,distance:()=>nn,div:()=>yn,divide:()=>kr,dot:()=>ln,equals:()=>gn,exactEquals:()=>bn,floor:()=>Qr,forEach:()=>An,fromValues:()=>Nr,inverse:()=>hn,len:()=>En,length:()=>sn,lerp:()=>dn,max:()=>Jr,min:()=>$r,mul:()=>Tn,multiply:()=>Hr,negate:()=>un,normalize:()=>cn,random:()=>Mn,round:()=>tn,scale:()=>en,scaleAndAdd:()=>rn,set:()=>Yr,sqrDist:()=>wn,sqrLen:()=>Ln,squaredDistance:()=>an,squaredLength:()=>on,str:()=>xn,sub:()=>_n,subtract:()=>zr,transformMat4:()=>pn,transformQuat:()=>mn,zero:()=>vn});var c={};r.r(c),r.d(c,{add:()=>ai,calculateW:()=>Cn,clone:()=>ei,conjugate:()=>Yn,copy:()=>ni,create:()=>Rn,dot:()=>ui,equals:()=>mi,exactEquals:()=>pi,exp:()=>qn,fromEuler:()=>zn,fromMat3:()=>Zn,fromValues:()=>ri,getAngle:()=>jn,getAxisAngle:()=>In,identity:()=>Un,invert:()=>Wn,len:()=>li,length:()=>ci,lerp:()=>hi,ln:()=>On,mul:()=>si,multiply:()=>Sn,normalize:()=>Mi,pow:()=>Fn,random:()=>Nn,rotateX:()=>Gn,rotateY:()=>Dn,rotateZ:()=>Vn,rotationTo:()=>vi,scale:()=>oi,set:()=>ii,setAxes:()=>bi,setAxisAngle:()=>Bn,slerp:()=>Xn,sqlerp:()=>xi,sqrLen:()=>di,squaredLength:()=>fi,str:()=>Hn});var l={};r.r(l),r.d(l,{add:()=>Ni,clone:()=>_i,conjugate:()=>Ki,copy:()=>Ai,create:()=>gi,dot:()=>zi,equals:()=>ia,exactEquals:()=>na,fromMat4:()=>Li,fromRotation:()=>Ei,fromRotationTranslation:()=>Pi,fromRotationTranslationValues:()=>yi,fromTranslation:()=>wi,fromValues:()=>Ti,getDual:()=>Ii,getReal:()=>Bi,getTranslation:()=>Gi,identity:()=>Ri,invert:()=>ki,len:()=>$i,length:()=>Qi,lerp:()=>Hi,mul:()=>Yi,multiply:()=>Wi,normalize:()=>ea,rotateAroundAxis:()=>Xi,rotateByQuatAppend:()=>Oi,rotateByQuatPrepend:()=>Fi,rotateX:()=>Vi,rotateY:()=>Ci,rotateZ:()=>qi,scale:()=>Zi,set:()=>Ui,setDual:()=>Si,setReal:()=>ji,sqrLen:()=>ta,squaredLength:()=>Ji,str:()=>ra,translate:()=>Di});var f={};r.r(f),r.d(f,{add:()=>ca,angle:()=>Va,ceil:()=>Ma,clone:()=>sa,copy:()=>ua,create:()=>aa,cross:()=>Ra,dist:()=>Za,distance:()=>_a,div:()=>Ya,divide:()=>da,dot:()=>Aa,equals:()=>Fa,exactEquals:()=>Oa,floor:()=>pa,forEach:()=>ka,fromValues:()=>oa,inverse:()=>Ea,len:()=>Xa,length:()=>ya,lerp:()=>Ua,max:()=>va,min:()=>ma,mul:()=>Wa,multiply:()=>fa,negate:()=>wa,normalize:()=>La,random:()=>Ba,rotate:()=>Da,round:()=>xa,scale:()=>ba,scaleAndAdd:()=>ga,set:()=>ha,sqrDist:()=>za,sqrLen:()=>Ha,squaredDistance:()=>Ta,squaredLength:()=>Pa,str:()=>qa,sub:()=>Na,subtract:()=>la,transformMat2:()=>Ia,transformMat2d:()=>ja,transformMat3:()=>Sa,transformMat4:()=>Ga,zero:()=>Ca});var d=1e-6,M="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function m(t){M=t}var v=Math.PI/180;function x(t){return t*v}function b(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function g(){var t=new M(4);return M!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function _(t){var e=new M(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function T(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function P(t,e,r,n){var i=new M(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function w(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function E(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function L(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r*a-i*n;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t):null}function A(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function R(t){return t[0]*t[3]-t[2]*t[1]}function U(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[0],u=r[1],h=r[2],c=r[3];return t[0]=n*o+a*u,t[1]=i*o+s*u,t[2]=n*h+a*c,t[3]=i*h+s*c,t}function B(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=n*u+a*o,t[1]=i*u+s*o,t[2]=n*-o+a*u,t[3]=i*-o+s*u,t}function I(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[0],u=r[1];return t[0]=n*o,t[1]=i*o,t[2]=a*u,t[3]=s*u,t}function j(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function S(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function G(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function D(t){return Math.hypot(t[0],t[1],t[2],t[3])}function V(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function C(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function q(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function O(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function F(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=e[0],o=e[1],u=e[2],h=e[3];return Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))}function X(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function N(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var W=U,Y=q;function Z(){var t=new M(6);return M!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function z(t){var e=new M(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function H(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function k(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function K(t,e,r,n,i,a){var s=new M(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s[4]=i,s[5]=a,s}function Q(t,e,r,n,i,a,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=s,t}function $(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=r*a-n*i;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*o-a*s)*u,t[5]=(n*s-r*o)*u,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=r[0],c=r[1],l=r[2],f=r[3],d=r[4],M=r[5];return t[0]=n*h+a*c,t[1]=i*h+s*c,t[2]=n*l+a*f,t[3]=i*l+s*f,t[4]=n*d+a*M+o,t[5]=i*d+s*M+u,t}function et(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=Math.sin(r),c=Math.cos(r);return t[0]=n*c+a*h,t[1]=i*c+s*h,t[2]=n*-h+a*c,t[3]=i*-h+s*c,t[4]=o,t[5]=u,t}function rt(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=r[0],c=r[1];return t[0]=n*h,t[1]=i*h,t[2]=a*c,t[3]=s*c,t[4]=o,t[5]=u,t}function nt(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=r[0],c=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=n*h+a*c+o,t[5]=i*h+s*c+u,t}function it(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function at(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function st(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ot(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ht(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function ct(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function lt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ft(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function Mt(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=e[0],h=e[1],c=e[2],l=e[3],f=e[4],M=e[5];return Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-c)<=d*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-l)<=d*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(s-f)<=d*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(o-M)<=d*Math.max(1,Math.abs(o),Math.abs(M))}var pt=tt,mt=ct;function vt(){var t=new M(9);return M!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function xt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new M(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function _t(t,e,r,n,i,a,s,o,u){var h=new M(9);return h[0]=t,h[1]=e,h[2]=r,h[3]=n,h[4]=i,h[5]=a,h[6]=s,h[7]=o,h[8]=u,h}function Tt(t,e,r,n,i,a,s,o,u,h){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t[8]=h,t}function yt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Pt(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function wt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=c*s-o*h,f=-c*a+o*u,d=h*a-s*u,M=r*l+n*f+i*d;return M?(M=1/M,t[0]=l*M,t[1]=(-c*n+i*h)*M,t[2]=(o*n-i*s)*M,t[3]=f*M,t[4]=(c*r-i*u)*M,t[5]=(-o*r+i*a)*M,t[6]=d*M,t[7]=(-h*r+n*u)*M,t[8]=(s*r-n*a)*M,t):null}function Et(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8];return t[0]=s*c-o*h,t[1]=i*h-n*c,t[2]=n*o-i*s,t[3]=o*u-a*c,t[4]=r*c-i*u,t[5]=i*a-r*o,t[6]=a*h-s*u,t[7]=n*u-r*h,t[8]=r*s-n*a,t}function Lt(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8];return e*(h*a-s*u)+r*(-h*i+s*o)+n*(u*i-a*o)}function At(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=r[0],d=r[1],M=r[2],p=r[3],m=r[4],v=r[5],x=r[6],b=r[7],g=r[8];return t[0]=f*n+d*s+M*h,t[1]=f*i+d*o+M*c,t[2]=f*a+d*u+M*l,t[3]=p*n+m*s+v*h,t[4]=p*i+m*o+v*c,t[5]=p*a+m*u+v*l,t[6]=x*n+b*s+g*h,t[7]=x*i+b*o+g*c,t[8]=x*a+b*u+g*l,t}function Rt(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=f*n+d*s+h,t[7]=f*i+d*o+c,t[8]=f*a+d*u+l,t}function Ut(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=Math.sin(r),d=Math.cos(r);return t[0]=d*n+f*s,t[1]=d*i+f*o,t[2]=d*a+f*u,t[3]=d*s-f*n,t[4]=d*o-f*i,t[5]=d*u-f*a,t[6]=h,t[7]=c,t[8]=l,t}function Bt(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function It(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function jt(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function St(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Dt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,u=i+i,h=r*s,c=n*s,l=n*o,f=i*s,d=i*o,M=i*u,p=a*s,m=a*o,v=a*u;return t[0]=1-l-M,t[3]=c-v,t[6]=f+m,t[1]=c+v,t[4]=1-h-M,t[7]=d-p,t[2]=f-m,t[5]=d+p,t[8]=1-h-l,t}function Vt(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],d=e[11],M=e[12],p=e[13],m=e[14],v=e[15],x=r*o-n*s,b=r*u-i*s,g=r*h-a*s,_=n*u-i*o,T=n*h-a*o,y=i*h-a*u,P=c*p-l*M,w=c*m-f*M,E=c*v-d*M,L=l*m-f*p,A=l*v-d*p,R=f*v-d*m,U=x*R-b*A+g*L+_*E-T*w+y*P;return U?(U=1/U,t[0]=(o*R-u*A+h*L)*U,t[1]=(u*E-s*R-h*w)*U,t[2]=(s*A-o*E+h*P)*U,t[3]=(i*A-n*R-a*L)*U,t[4]=(r*R-i*E+a*w)*U,t[5]=(n*E-r*A-a*P)*U,t[6]=(p*y-m*T+v*_)*U,t[7]=(m*g-M*y-v*b)*U,t[8]=(M*T-p*g+v*x)*U,t):null}function Ct(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function qt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ot(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ft(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function Xt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function Nt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Wt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Yt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Zt(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],c=t[8],l=e[0],f=e[1],M=e[2],p=e[3],m=e[4],v=e[5],x=e[6],b=e[7],g=e[8];return Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-M)<=d*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(o-v)<=d*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(u-x)<=d*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(h-b)<=d*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))}var zt=At,Ht=Xt;function kt(){var t=new M(16);return M!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Kt(t){var e=new M(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $t(t,e,r,n,i,a,s,o,u,h,c,l,f,d,p,m){var v=new M(16);return v[0]=t,v[1]=e,v[2]=r,v[3]=n,v[4]=i,v[5]=a,v[6]=s,v[7]=o,v[8]=u,v[9]=h,v[10]=c,v[11]=l,v[12]=f,v[13]=d,v[14]=p,v[15]=m,v}function Jt(t,e,r,n,i,a,s,o,u,h,c,l,f,d,M,p,m){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t[8]=h,t[9]=c,t[10]=l,t[11]=f,t[12]=d,t[13]=M,t[14]=p,t[15]=m,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],d=e[11],M=e[12],p=e[13],m=e[14],v=e[15],x=r*o-n*s,b=r*u-i*s,g=r*h-a*s,_=n*u-i*o,T=n*h-a*o,y=i*h-a*u,P=c*p-l*M,w=c*m-f*M,E=c*v-d*M,L=l*m-f*p,A=l*v-d*p,R=f*v-d*m,U=x*R-b*A+g*L+_*E-T*w+y*P;return U?(U=1/U,t[0]=(o*R-u*A+h*L)*U,t[1]=(i*A-n*R-a*L)*U,t[2]=(p*y-m*T+v*_)*U,t[3]=(f*T-l*y-d*_)*U,t[4]=(u*E-s*R-h*w)*U,t[5]=(r*R-i*E+a*w)*U,t[6]=(m*g-M*y-v*b)*U,t[7]=(c*y-f*g+d*b)*U,t[8]=(s*A-o*E+h*P)*U,t[9]=(n*E-r*A-a*P)*U,t[10]=(M*T-p*g+v*x)*U,t[11]=(l*g-c*T-d*x)*U,t[12]=(o*w-s*L-u*P)*U,t[13]=(r*L-n*w+i*P)*U,t[14]=(p*b-M*_-m*x)*U,t[15]=(c*_-l*b+f*x)*U,t):null}function ne(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],d=e[11],M=e[12],p=e[13],m=e[14],v=e[15];return t[0]=o*(f*v-d*m)-l*(u*v-h*m)+p*(u*d-h*f),t[1]=-(n*(f*v-d*m)-l*(i*v-a*m)+p*(i*d-a*f)),t[2]=n*(u*v-h*m)-o*(i*v-a*m)+p*(i*h-a*u),t[3]=-(n*(u*d-h*f)-o*(i*d-a*f)+l*(i*h-a*u)),t[4]=-(s*(f*v-d*m)-c*(u*v-h*m)+M*(u*d-h*f)),t[5]=r*(f*v-d*m)-c*(i*v-a*m)+M*(i*d-a*f),t[6]=-(r*(u*v-h*m)-s*(i*v-a*m)+M*(i*h-a*u)),t[7]=r*(u*d-h*f)-s*(i*d-a*f)+c*(i*h-a*u),t[8]=s*(l*v-d*p)-c*(o*v-h*p)+M*(o*d-h*l),t[9]=-(r*(l*v-d*p)-c*(n*v-a*p)+M*(n*d-a*l)),t[10]=r*(o*v-h*p)-s*(n*v-a*p)+M*(n*h-a*o),t[11]=-(r*(o*d-h*l)-s*(n*d-a*l)+c*(n*h-a*o)),t[12]=-(s*(l*m-f*p)-c*(o*m-u*p)+M*(o*f-u*l)),t[13]=r*(l*m-f*p)-c*(n*m-i*p)+M*(n*f-i*l),t[14]=-(r*(o*m-u*p)-s*(n*m-i*p)+M*(n*u-i*o)),t[15]=r*(o*f-u*l)-s*(n*f-i*l)+c*(n*u-i*o),t}function ie(t){var e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],d=t[12],M=t[13],p=t[14],m=t[15];return(e*s-r*a)*(l*m-f*p)-(e*o-n*a)*(c*m-f*M)+(e*u-i*a)*(c*p-l*M)+(r*o-n*s)*(h*m-f*d)-(r*u-i*s)*(h*p-l*d)+(n*u-i*o)*(h*M-c*d)}function ae(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],d=e[10],M=e[11],p=e[12],m=e[13],v=e[14],x=e[15],b=r[0],g=r[1],_=r[2],T=r[3];return t[0]=b*n+g*o+_*l+T*p,t[1]=b*i+g*u+_*f+T*m,t[2]=b*a+g*h+_*d+T*v,t[3]=b*s+g*c+_*M+T*x,b=r[4],g=r[5],_=r[6],T=r[7],t[4]=b*n+g*o+_*l+T*p,t[5]=b*i+g*u+_*f+T*m,t[6]=b*a+g*h+_*d+T*v,t[7]=b*s+g*c+_*M+T*x,b=r[8],g=r[9],_=r[10],T=r[11],t[8]=b*n+g*o+_*l+T*p,t[9]=b*i+g*u+_*f+T*m,t[10]=b*a+g*h+_*d+T*v,t[11]=b*s+g*c+_*M+T*x,b=r[12],g=r[13],_=r[14],T=r[15],t[12]=b*n+g*o+_*l+T*p,t[13]=b*i+g*u+_*f+T*m,t[14]=b*a+g*h+_*d+T*v,t[15]=b*s+g*c+_*M+T*x,t}function se(t,e,r){var n,i,a,s,o,u,h,c,l,f,d,M,p=r[0],m=r[1],v=r[2];return e===t?(t[12]=e[0]*p+e[4]*m+e[8]*v+e[12],t[13]=e[1]*p+e[5]*m+e[9]*v+e[13],t[14]=e[2]*p+e[6]*m+e[10]*v+e[14],t[15]=e[3]*p+e[7]*m+e[11]*v+e[15]):(n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],d=e[10],M=e[11],t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=h,t[7]=c,t[8]=l,t[9]=f,t[10]=d,t[11]=M,t[12]=n*p+o*m+l*v+e[12],t[13]=i*p+u*m+f*v+e[13],t[14]=a*p+h*m+d*v+e[14],t[15]=s*p+c*m+M*v+e[15]),t}function oe(t,e,r){var n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){var i,a,s,o,u,h,c,l,f,M,p,m,v,x,b,g,_,T,y,P,w,E,L,A,R=n[0],U=n[1],B=n[2],I=Math.hypot(R,U,B);return I<d?null:(R*=I=1/I,U*=I,B*=I,i=Math.sin(r),s=1-(a=Math.cos(r)),o=e[0],u=e[1],h=e[2],c=e[3],l=e[4],f=e[5],M=e[6],p=e[7],m=e[8],v=e[9],x=e[10],b=e[11],g=R*R*s+a,_=U*R*s+B*i,T=B*R*s-U*i,y=R*U*s-B*i,P=U*U*s+a,w=B*U*s+R*i,E=R*B*s+U*i,L=U*B*s-R*i,A=B*B*s+a,t[0]=o*g+l*_+m*T,t[1]=u*g+f*_+v*T,t[2]=h*g+M*_+x*T,t[3]=c*g+p*_+b*T,t[4]=o*y+l*P+m*w,t[5]=u*y+f*P+v*w,t[6]=h*y+M*P+x*w,t[7]=c*y+p*P+b*w,t[8]=o*E+l*L+m*A,t[9]=u*E+f*L+v*A,t[10]=h*E+M*L+x*A,t[11]=c*E+p*L+b*A,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function he(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[4],s=e[5],o=e[6],u=e[7],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+h*n,t[5]=s*i+c*n,t[6]=o*i+l*n,t[7]=u*i+f*n,t[8]=h*i-a*n,t[9]=c*i-s*n,t[10]=l*i-o*n,t[11]=f*i-u*n,t}function ce(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-h*n,t[1]=s*i-c*n,t[2]=o*i-l*n,t[3]=u*i-f*n,t[8]=a*n+h*i,t[9]=s*n+c*i,t[10]=o*n+l*i,t[11]=u*n+f*i,t}function le(t,e,r){var n=Math.sin(r),i=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[4],c=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+h*n,t[1]=s*i+c*n,t[2]=o*i+l*n,t[3]=u*i+f*n,t[4]=h*i-a*n,t[5]=c*i-s*n,t[6]=l*i-o*n,t[7]=f*i-u*n,t}function fe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Me(t,e,r){var n,i,a,s=r[0],o=r[1],u=r[2],h=Math.hypot(s,o,u);return h<d?null:(s*=h=1/h,o*=h,u*=h,n=Math.sin(e),a=1-(i=Math.cos(e)),t[0]=s*s*a+i,t[1]=o*s*a+u*n,t[2]=u*s*a-o*n,t[3]=0,t[4]=s*o*a-u*n,t[5]=o*o*a+i,t[6]=u*o*a+s*n,t[7]=0,t[8]=s*u*a+o*n,t[9]=o*u*a-s*n,t[10]=u*u*a+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function xe(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=n+n,u=i+i,h=a+a,c=n*o,l=n*u,f=n*h,d=i*u,M=i*h,p=a*h,m=s*o,v=s*u,x=s*h;return t[0]=1-(d+p),t[1]=l+x,t[2]=f-v,t[3]=0,t[4]=l-x,t[5]=1-(c+p),t[6]=M+m,t[7]=0,t[8]=f+v,t[9]=M-m,t[10]=1-(c+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e){var r=new M(3),n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=n*n+i*i+a*a+s*s;return l>0?(r[0]=2*(o*s+c*n+u*a-h*i)/l,r[1]=2*(u*s+c*i+h*n-o*a)/l,r[2]=2*(h*s+c*a+o*i-u*n)/l):(r[0]=2*(o*s+c*n+u*a-h*i),r[1]=2*(u*s+c*i+h*n-o*a),r[2]=2*(h*s+c*a+o*i-u*n)),xe(t,e,r),t}function ge(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function _e(t,e){var r=e[0],n=e[1],i=e[2],a=e[4],s=e[5],o=e[6],u=e[8],h=e[9],c=e[10];return t[0]=Math.hypot(r,n,i),t[1]=Math.hypot(a,s,o),t[2]=Math.hypot(u,h,c),t}function Te(t,e){var r=new M(3);_e(r,e);var n=1/r[0],i=1/r[1],a=1/r[2],s=e[0]*n,o=e[1]*i,u=e[2]*a,h=e[4]*n,c=e[5]*i,l=e[6]*a,f=e[8]*n,d=e[9]*i,p=e[10]*a,m=s+c+p,v=0;return m>0?(v=2*Math.sqrt(m+1),t[3]=.25*v,t[0]=(l-d)/v,t[1]=(f-u)/v,t[2]=(o-h)/v):s>c&&s>p?(v=2*Math.sqrt(1+s-c-p),t[3]=(l-d)/v,t[0]=.25*v,t[1]=(o+h)/v,t[2]=(f+u)/v):c>p?(v=2*Math.sqrt(1+c-s-p),t[3]=(f-u)/v,t[0]=(o+h)/v,t[1]=.25*v,t[2]=(l+d)/v):(v=2*Math.sqrt(1+p-s-c),t[3]=(o-h)/v,t[0]=(f+u)/v,t[1]=(l+d)/v,t[2]=.25*v),t}function ye(t,e,r,n){var i=e[0],a=e[1],s=e[2],o=e[3],u=i+i,h=a+a,c=s+s,l=i*u,f=i*h,d=i*c,M=a*h,p=a*c,m=s*c,v=o*u,x=o*h,b=o*c,g=n[0],_=n[1],T=n[2];return t[0]=(1-(M+m))*g,t[1]=(f+b)*g,t[2]=(d-x)*g,t[3]=0,t[4]=(f-b)*_,t[5]=(1-(l+m))*_,t[6]=(p+v)*_,t[7]=0,t[8]=(d+x)*T,t[9]=(p-v)*T,t[10]=(1-(l+M))*T,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Pe(t,e,r,n,i){var a=e[0],s=e[1],o=e[2],u=e[3],h=a+a,c=s+s,l=o+o,f=a*h,d=a*c,M=a*l,p=s*c,m=s*l,v=o*l,x=u*h,b=u*c,g=u*l,_=n[0],T=n[1],y=n[2],P=i[0],w=i[1],E=i[2],L=(1-(p+v))*_,A=(d+g)*_,R=(M-b)*_,U=(d-g)*T,B=(1-(f+v))*T,I=(m+x)*T,j=(M+b)*y,S=(m-x)*y,G=(1-(f+p))*y;return t[0]=L,t[1]=A,t[2]=R,t[3]=0,t[4]=U,t[5]=B,t[6]=I,t[7]=0,t[8]=j,t[9]=S,t[10]=G,t[11]=0,t[12]=r[0]+P-(L*P+U*w+j*E),t[13]=r[1]+w-(A*P+B*w+S*E),t[14]=r[2]+E-(R*P+I*w+G*E),t[15]=1,t}function we(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r+r,o=n+n,u=i+i,h=r*s,c=n*s,l=n*o,f=i*s,d=i*o,M=i*u,p=a*s,m=a*o,v=a*u;return t[0]=1-l-M,t[1]=c+v,t[2]=f-m,t[3]=0,t[4]=c-v,t[5]=1-h-M,t[6]=d+p,t[7]=0,t[8]=f+m,t[9]=d-p,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ee(t,e,r,n,i,a,s){var o=1/(r-e),u=1/(i-n),h=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(i+n)*u,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*h,t[15]=0,t}function Le(t,e,r,n,i){var a,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=(i+n)*a,t[14]=2*i*n*a):(t[10]=-1,t[14]=-2*n),t}var Ae=Le;function Re(t,e,r,n,i){var a,s=1/Math.tan(e/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(n-i),t[10]=i*a,t[14]=i*n*a):(t[10]=-1,t[14]=-n),t}function Ue(t,e,r,n){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),h=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=h,t[6]=0,t[7]=0,t[8]=-(s-o)*u*.5,t[9]=(i-a)*h*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Be(t,e,r,n,i,a,s){var o=1/(e-r),u=1/(n-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*u,t[14]=(s+a)*h,t[15]=1,t}var Ie=Be;function je(t,e,r,n,i,a,s){var o=1/(e-r),u=1/(n-i),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=h,t[11]=0,t[12]=(e+r)*o,t[13]=(i+n)*u,t[14]=a*h,t[15]=1,t}function Se(t,e,r,n){var i,a,s,o,u,h,c,l,f,M,p=e[0],m=e[1],v=e[2],x=n[0],b=n[1],g=n[2],_=r[0],T=r[1],y=r[2];return Math.abs(p-_)<d&&Math.abs(m-T)<d&&Math.abs(v-y)<d?te(t):(c=p-_,l=m-T,f=v-y,i=b*(f*=M=1/Math.hypot(c,l,f))-g*(l*=M),a=g*(c*=M)-x*f,s=x*l-b*c,(M=Math.hypot(i,a,s))?(i*=M=1/M,a*=M,s*=M):(i=0,a=0,s=0),o=l*s-f*a,u=f*i-c*s,h=c*a-l*i,(M=Math.hypot(o,u,h))?(o*=M=1/M,u*=M,h*=M):(o=0,u=0,h=0),t[0]=i,t[1]=o,t[2]=c,t[3]=0,t[4]=a,t[5]=u,t[6]=l,t[7]=0,t[8]=s,t[9]=h,t[10]=f,t[11]=0,t[12]=-(i*p+a*m+s*v),t[13]=-(o*p+u*m+h*v),t[14]=-(c*p+l*m+f*v),t[15]=1,t)}function Ge(t,e,r,n){var i=e[0],a=e[1],s=e[2],o=n[0],u=n[1],h=n[2],c=i-r[0],l=a-r[1],f=s-r[2],d=c*c+l*l+f*f;d>0&&(c*=d=1/Math.sqrt(d),l*=d,f*=d);var M=u*f-h*l,p=h*c-o*f,m=o*l-u*c;return(d=M*M+p*p+m*m)>0&&(M*=d=1/Math.sqrt(d),p*=d,m*=d),t[0]=M,t[1]=p,t[2]=m,t[3]=0,t[4]=l*m-f*p,t[5]=f*M-c*m,t[6]=c*p-l*M,t[7]=0,t[8]=c,t[9]=l,t[10]=f,t[11]=0,t[12]=i,t[13]=a,t[14]=s,t[15]=1,t}function De(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ve(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ce(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function qe(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Oe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function Fe(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function Xe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ne(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],c=t[8],l=t[9],f=t[10],M=t[11],p=t[12],m=t[13],v=t[14],x=t[15],b=e[0],g=e[1],_=e[2],T=e[3],y=e[4],P=e[5],w=e[6],E=e[7],L=e[8],A=e[9],R=e[10],U=e[11],B=e[12],I=e[13],j=e[14],S=e[15];return Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-g)<=d*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-_)<=d*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-T)<=d*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-y)<=d*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(o-P)<=d*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(u-w)<=d*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-E)<=d*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(c-L)<=d*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(l-A)<=d*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(f-R)<=d*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(M-U)<=d*Math.max(1,Math.abs(M),Math.abs(U))&&Math.abs(p-B)<=d*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(m-I)<=d*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-j)<=d*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(x-S)<=d*Math.max(1,Math.abs(x),Math.abs(S))}var We=ae,Ye=qe;function Ze(){var t=new M(3);return M!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ze(t){var e=new M(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function He(t){var e=t[0],r=t[1],n=t[2];return Math.hypot(e,r,n)}function ke(t,e,r){var n=new M(3);return n[0]=t,n[1]=e,n[2]=r,n}function Ke(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Qe(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function $e(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Je(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function tr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function er(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function rr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function nr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function ir(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function ar(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function sr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function or(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ur(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function hr(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.hypot(r,n,i)}function cr(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function lr(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function fr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function dr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Mr(t,e){var r=e[0],n=e[1],i=e[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function pr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mr(t,e,r){var n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],u=r[2];return t[0]=i*u-a*o,t[1]=a*s-n*u,t[2]=n*o-i*s,t}function vr(t,e,r,n){var i=e[0],a=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t}function xr(t,e,r,n,i,a){var s=a*a,o=s*(2*a-3)+1,u=s*(a-2)+a,h=s*(a-1),c=s*(3-2*a);return t[0]=e[0]*o+r[0]*u+n[0]*h+i[0]*c,t[1]=e[1]*o+r[1]*u+n[1]*h+i[1]*c,t[2]=e[2]*o+r[2]*u+n[2]*h+i[2]*c,t}function br(t,e,r,n,i,a){var s=1-a,o=s*s,u=a*a,h=o*s,c=3*a*o,l=3*u*s,f=u*a;return t[0]=e[0]*h+r[0]*c+n[0]*l+i[0]*f,t[1]=e[1]*h+r[1]*c+n[1]*l+i[1]*f,t[2]=e[2]*h+r[2]*c+n[2]*l+i[2]*f,t}function gr(t,e){e=e||1;var r=2*p()*Math.PI,n=2*p()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function _r(t,e,r){var n=e[0],i=e[1],a=e[2],s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,t}function Tr(t,e,r){var n=e[0],i=e[1],a=e[2];return t[0]=n*r[0]+i*r[3]+a*r[6],t[1]=n*r[1]+i*r[4]+a*r[7],t[2]=n*r[2]+i*r[5]+a*r[8],t}function yr(t,e,r){var n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],h=e[2],c=i*h-a*u,l=a*o-n*h,f=n*u-i*o,d=i*f-a*l,M=a*c-n*f,p=n*l-i*c,m=2*s;return c*=m,l*=m,f*=m,d*=2,M*=2,p*=2,t[0]=o+c+d,t[1]=u+l+M,t[2]=h+f+p,t}function Pr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function wr(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Er(t,e,r,n){var i=[],a=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t}function Lr(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2],u=Math.sqrt(r*r+n*n+i*i)*Math.sqrt(a*a+s*s+o*o),h=u&&pr(t,e)/u;return Math.acos(Math.min(Math.max(h,-1),1))}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t}function Rr(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ur(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Br(t,e){var r=t[0],n=t[1],i=t[2],a=e[0],s=e[1],o=e[2];return Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-o)<=d*Math.max(1,Math.abs(i),Math.abs(o))}var Ir,jr=Je,Sr=tr,Gr=er,Dr=hr,Vr=cr,Cr=He,qr=lr,Or=(Ir=Ze(),function(t,e,r,n,i,a){var s,o;for(e||(e=3),r||(r=0),o=n?Math.min(n*e+r,t.length):t.length,s=r;s<o;s+=e)Ir[0]=t[s],Ir[1]=t[s+1],Ir[2]=t[s+2],i(Ir,Ir,a),t[s]=Ir[0],t[s+1]=Ir[1],t[s+2]=Ir[2];return t});function Fr(){var t=new M(4);return M!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Xr(t){var e=new M(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Nr(t,e,r,n){var i=new M(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function Wr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Yr(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function Zr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function zr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Hr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function kr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Kr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Qr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function $r(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Jr(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function tn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function en(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function rn(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function nn(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(r,n,i,a)}function an(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return r*r+n*n+i*i+a*a}function sn(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.hypot(e,r,n,i)}function on(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function un(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function hn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function cn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r*r+n*n+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=a*s,t}function ln(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function fn(t,e,r,n){var i=r[0]*n[1]-r[1]*n[0],a=r[0]*n[2]-r[2]*n[0],s=r[0]*n[3]-r[3]*n[0],o=r[1]*n[2]-r[2]*n[1],u=r[1]*n[3]-r[3]*n[1],h=r[2]*n[3]-r[3]*n[2],c=e[0],l=e[1],f=e[2],d=e[3];return t[0]=l*h-f*u+d*o,t[1]=-c*h+f*s-d*a,t[2]=c*u-l*s+d*i,t[3]=-c*o+l*a-f*i,t}function dn(t,e,r,n){var i=e[0],a=e[1],s=e[2],o=e[3];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t[2]=s+n*(r[2]-s),t[3]=o+n*(r[3]-o),t}function Mn(t,e){var r,n,i,a,s,o;e=e||1;do{s=(r=2*p()-1)*r+(n=2*p()-1)*n}while(s>=1);do{o=(i=2*p()-1)*i+(a=2*p()-1)*a}while(o>=1);var u=Math.sqrt((1-s)/o);return t[0]=e*r,t[1]=e*n,t[2]=e*i*u,t[3]=e*a*u,t}function pn(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,t}function mn(t,e,r){var n=e[0],i=e[1],a=e[2],s=r[0],o=r[1],u=r[2],h=r[3],c=h*n+o*a-u*i,l=h*i+u*n-s*a,f=h*a+s*i-o*n,d=-s*n-o*i-u*a;return t[0]=c*h+d*-s+l*-u-f*-o,t[1]=l*h+d*-o+f*-s-c*-u,t[2]=f*h+d*-u+c*-o-l*-s,t[3]=e[3],t}function vn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function xn(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function bn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function gn(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=e[0],o=e[1],u=e[2],h=e[3];return Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))}var _n=zr,Tn=Hr,yn=kr,Pn=nn,wn=an,En=sn,Ln=on,An=function(){var t=Fr();return function(e,r,n,i,a,s){var o,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function Rn(){var t=new M(4);return M!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Un(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Bn(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function In(t,e){var r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>d?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function jn(t,e){var r=ui(t,e);return Math.acos(2*r*r-1)}function Sn(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[0],u=r[1],h=r[2],c=r[3];return t[0]=n*c+s*o+i*h-a*u,t[1]=i*c+s*u+a*o-n*h,t[2]=a*c+s*h+n*u-i*o,t[3]=s*c-n*o-i*u-a*h,t}function Gn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=n*u+s*o,t[1]=i*u+a*o,t[2]=a*u-i*o,t[3]=s*u-n*o,t}function Dn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=n*u-a*o,t[1]=i*u+s*o,t[2]=a*u+n*o,t[3]=s*u-i*o,t}function Vn(t,e,r){r*=.5;var n=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*o,t[1]=i*u-n*o,t[2]=a*u+s*o,t[3]=s*u-a*o,t}function Cn(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function qn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(r*r+n*n+i*i),o=Math.exp(a),u=s>0?o*Math.sin(s)/s:0;return t[0]=r*u,t[1]=n*u,t[2]=i*u,t[3]=o*Math.cos(s),t}function On(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=Math.sqrt(r*r+n*n+i*i),o=s>0?Math.atan2(s,a)/s:0;return t[0]=r*o,t[1]=n*o,t[2]=i*o,t[3]=.5*Math.log(r*r+n*n+i*i+a*a),t}function Fn(t,e,r){return On(t,e),oi(t,t,r),qn(t,t),t}function Xn(t,e,r,n){var i,a,s,o,u,h=e[0],c=e[1],l=e[2],f=e[3],M=r[0],p=r[1],m=r[2],v=r[3];return(a=h*M+c*p+l*m+f*v)<0&&(a=-a,M=-M,p=-p,m=-m,v=-v),1-a>d?(i=Math.acos(a),s=Math.sin(i),o=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(o=1-n,u=n),t[0]=o*h+u*M,t[1]=o*c+u*p,t[2]=o*l+u*m,t[3]=o*f+u*v,t}function Nn(t){var e=p(),r=p(),n=p(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t}function Wn(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],s=r*r+n*n+i*i+a*a,o=s?1/s:0;return t[0]=-r*o,t[1]=-n*o,t[2]=-i*o,t[3]=a*o,t}function Yn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Zn(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*s+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+s]-e[3*s+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[s]=(e[3*s+i]+e[3*i+s])*r}return t}function zn(t,e,r,n){var i=.5*Math.PI/180;e*=i,r*=i,n*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(r),u=Math.cos(r),h=Math.sin(n),c=Math.cos(n);return t[0]=a*u*c-s*o*h,t[1]=s*o*c+a*u*h,t[2]=s*u*h-a*o*c,t[3]=s*u*c+a*o*h,t}function Hn(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var kn,Kn,Qn,$n,Jn,ti,ei=Xr,ri=Nr,ni=Wr,ii=Yr,ai=Zr,si=Sn,oi=en,ui=ln,hi=dn,ci=sn,li=ci,fi=on,di=fi,Mi=cn,pi=bn,mi=gn,vi=(kn=Ze(),Kn=ke(1,0,0),Qn=ke(0,1,0),function(t,e,r){var n=pr(e,r);return n<-.999999?(mr(kn,Kn,e),Cr(kn)<1e-6&&mr(kn,Qn,e),Mr(kn,kn),Bn(t,kn,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(mr(kn,e,r),t[0]=kn[0],t[1]=kn[1],t[2]=kn[2],t[3]=1+n,Mi(t,t))}),xi=($n=Rn(),Jn=Rn(),function(t,e,r,n,i,a){return Xn($n,e,i,a),Xn(Jn,r,n,a),Xn(t,$n,Jn,2*a*(1-a)),t}),bi=(ti=vt(),function(t,e,r,n){return ti[0]=r[0],ti[3]=r[1],ti[6]=r[2],ti[1]=n[0],ti[4]=n[1],ti[7]=n[2],ti[2]=-e[0],ti[5]=-e[1],ti[8]=-e[2],Mi(t,Zn(t,ti))});function gi(){var t=new M(8);return M!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function _i(t){var e=new M(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Ti(t,e,r,n,i,a,s,o){var u=new M(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=a,u[6]=s,u[7]=o,u}function yi(t,e,r,n,i,a,s){var o=new M(8);o[0]=t,o[1]=e,o[2]=r,o[3]=n;var u=.5*i,h=.5*a,c=.5*s;return o[4]=u*n+h*r-c*e,o[5]=h*n+c*t-u*r,o[6]=c*n+u*e-h*t,o[7]=-u*t-h*e-c*r,o}function Pi(t,e,r){var n=.5*r[0],i=.5*r[1],a=.5*r[2],s=e[0],o=e[1],u=e[2],h=e[3];return t[0]=s,t[1]=o,t[2]=u,t[3]=h,t[4]=n*h+i*u-a*o,t[5]=i*h+a*s-n*u,t[6]=a*h+n*o-i*s,t[7]=-n*s-i*o-a*u,t}function wi(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function Ei(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Li(t,e){var r=Rn();Te(r,e);var n=new M(3);return ge(n,e),Pi(t,r,n),t}function Ai(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ri(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ui(t,e,r,n,i,a,s,o,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t}var Bi=ni;function Ii(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var ji=ni;function Si(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Gi(t,e){var r=e[4],n=e[5],i=e[6],a=e[7],s=-e[0],o=-e[1],u=-e[2],h=e[3];return t[0]=2*(r*h+a*s+n*u-i*o),t[1]=2*(n*h+a*o+i*s-r*u),t[2]=2*(i*h+a*u+r*o-n*s),t}function Di(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=.5*r[0],u=.5*r[1],h=.5*r[2],c=e[4],l=e[5],f=e[6],d=e[7];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=s*o+i*h-a*u+c,t[5]=s*u+a*o-n*h+l,t[6]=s*h+n*u-i*o+f,t[7]=-n*o-i*u-a*h+d,t}function Vi(t,e,r){var n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=o*s+c*n+u*a-h*i,f=u*s+c*i+h*n-o*a,d=h*s+c*a+o*i-u*n,M=c*s-o*n-u*i-h*a;return Gn(t,e,r),n=t[0],i=t[1],a=t[2],s=t[3],t[4]=l*s+M*n+f*a-d*i,t[5]=f*s+M*i+d*n-l*a,t[6]=d*s+M*a+l*i-f*n,t[7]=M*s-l*n-f*i-d*a,t}function Ci(t,e,r){var n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=o*s+c*n+u*a-h*i,f=u*s+c*i+h*n-o*a,d=h*s+c*a+o*i-u*n,M=c*s-o*n-u*i-h*a;return Dn(t,e,r),n=t[0],i=t[1],a=t[2],s=t[3],t[4]=l*s+M*n+f*a-d*i,t[5]=f*s+M*i+d*n-l*a,t[6]=d*s+M*a+l*i-f*n,t[7]=M*s-l*n-f*i-d*a,t}function qi(t,e,r){var n=-e[0],i=-e[1],a=-e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=o*s+c*n+u*a-h*i,f=u*s+c*i+h*n-o*a,d=h*s+c*a+o*i-u*n,M=c*s-o*n-u*i-h*a;return Vn(t,e,r),n=t[0],i=t[1],a=t[2],s=t[3],t[4]=l*s+M*n+f*a-d*i,t[5]=f*s+M*i+d*n-l*a,t[6]=d*s+M*a+l*i-f*n,t[7]=M*s-l*n-f*i-d*a,t}function Oi(t,e,r){var n=r[0],i=r[1],a=r[2],s=r[3],o=e[0],u=e[1],h=e[2],c=e[3];return t[0]=o*s+c*n+u*a-h*i,t[1]=u*s+c*i+h*n-o*a,t[2]=h*s+c*a+o*i-u*n,t[3]=c*s-o*n-u*i-h*a,o=e[4],u=e[5],h=e[6],c=e[7],t[4]=o*s+c*n+u*a-h*i,t[5]=u*s+c*i+h*n-o*a,t[6]=h*s+c*a+o*i-u*n,t[7]=c*s-o*n-u*i-h*a,t}function Fi(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[0],u=r[1],h=r[2],c=r[3];return t[0]=n*c+s*o+i*h-a*u,t[1]=i*c+s*u+a*o-n*h,t[2]=a*c+s*h+n*u-i*o,t[3]=s*c-n*o-i*u-a*h,o=r[4],u=r[5],h=r[6],c=r[7],t[4]=n*c+s*o+i*h-a*u,t[5]=i*c+s*u+a*o-n*h,t[6]=a*c+s*h+n*u-i*o,t[7]=s*c-n*o-i*u-a*h,t}function Xi(t,e,r,n){if(Math.abs(n)<d)return Ai(t,e);var i=Math.hypot(r[0],r[1],r[2]);n*=.5;var a=Math.sin(n),s=a*r[0]/i,o=a*r[1]/i,u=a*r[2]/i,h=Math.cos(n),c=e[0],l=e[1],f=e[2],M=e[3];t[0]=c*h+M*s+l*u-f*o,t[1]=l*h+M*o+f*s-c*u,t[2]=f*h+M*u+c*o-l*s,t[3]=M*h-c*s-l*o-f*u;var p=e[4],m=e[5],v=e[6],x=e[7];return t[4]=p*h+x*s+m*u-v*o,t[5]=m*h+x*o+v*s-p*u,t[6]=v*h+x*u+p*o-m*s,t[7]=x*h-p*s-m*o-v*u,t}function Ni(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function Wi(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=r[4],u=r[5],h=r[6],c=r[7],l=e[4],f=e[5],d=e[6],M=e[7],p=r[0],m=r[1],v=r[2],x=r[3];return t[0]=n*x+s*p+i*v-a*m,t[1]=i*x+s*m+a*p-n*v,t[2]=a*x+s*v+n*m-i*p,t[3]=s*x-n*p-i*m-a*v,t[4]=n*c+s*o+i*h-a*u+l*x+M*p+f*v-d*m,t[5]=i*c+s*u+a*o-n*h+f*x+M*m+d*p-l*v,t[6]=a*c+s*h+n*u-i*o+d*x+M*v+l*m-f*p,t[7]=s*c-n*o-i*u-a*h+M*x-l*p-f*m-d*v,t}var Yi=Wi;function Zi(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}var zi=ui;function Hi(t,e,r,n){var i=1-n;return zi(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t}function ki(t,e){var r=Ji(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Ki(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Qi=ci,$i=Qi,Ji=fi,ta=Ji;function ea(t,e){var r=Ji(e);if(r>0){r=Math.sqrt(r);var n=e[0]/r,i=e[1]/r,a=e[2]/r,s=e[3]/r,o=e[4],u=e[5],h=e[6],c=e[7],l=n*o+i*u+a*h+s*c;t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=(o-n*l)/r,t[5]=(u-i*l)/r,t[6]=(h-a*l)/r,t[7]=(c-s*l)/r}return t}function ra(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function na(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ia(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],u=t[6],h=t[7],c=e[0],l=e[1],f=e[2],M=e[3],p=e[4],m=e[5],v=e[6],x=e[7];return Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-l)<=d*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-M)<=d*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-p)<=d*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-m)<=d*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(u-v)<=d*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-x)<=d*Math.max(1,Math.abs(h),Math.abs(x))}function aa(){var t=new M(2);return M!=Float32Array&&(t[0]=0,t[1]=0),t}function sa(t){var e=new M(2);return e[0]=t[0],e[1]=t[1],e}function oa(t,e){var r=new M(2);return r[0]=t,r[1]=e,r}function ua(t,e){return t[0]=e[0],t[1]=e[1],t}function ha(t,e,r){return t[0]=e,t[1]=r,t}function ca(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function la(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function fa(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function da(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Ma(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function pa(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function ma(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function va(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function xa(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function ba(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function ga(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function _a(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.hypot(r,n)}function Ta(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function ya(t){var e=t[0],r=t[1];return Math.hypot(e,r)}function Pa(t){var e=t[0],r=t[1];return e*e+r*r}function wa(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Ea(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function La(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Aa(t,e){return t[0]*e[0]+t[1]*e[1]}function Ra(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function Ua(t,e,r,n){var i=e[0],a=e[1];return t[0]=i+n*(r[0]-i),t[1]=a+n*(r[1]-a),t}function Ba(t,e){e=e||1;var r=2*p()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function Ia(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function ja(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function Sa(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function Ga(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function Da(t,e,r,n){var i=e[0]-r[0],a=e[1]-r[1],s=Math.sin(n),o=Math.cos(n);return t[0]=i*o-a*s+r[0],t[1]=i*s+a*o+r[1],t}function Va(t,e){var r=t[0],n=t[1],i=e[0],a=e[1],s=Math.sqrt(r*r+n*n)*Math.sqrt(i*i+a*a),o=s&&(r*i+n*a)/s;return Math.acos(Math.min(Math.max(o,-1),1))}function Ca(t){return t[0]=0,t[1]=0,t}function qa(t){return"vec2("+t[0]+", "+t[1]+")"}function Oa(t,e){return t[0]===e[0]&&t[1]===e[1]}function Fa(t,e){var r=t[0],n=t[1],i=e[0],a=e[1];return Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))}var Xa=ya,Na=la,Wa=fa,Ya=da,Za=_a,za=Ta,Ha=Pa,ka=function(){var t=aa();return function(e,r,n,i,a,s){var o,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,o=n;o<u;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}}()},489:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Core=void 0;const n=r(659),i=r(183),a=r(382),s=r(718);class o{constructor(){this._layers=[],this._layers.push(new s.NonRegularTileLayer(this)),this.setWorldPosition(0,0)}update(t){this._layers.forEach((e=>e.update(t)))}setWorldPosition(t,e){return this.originLatLon=new i.LatLon(t,e),this.origin=o.project(this.originLatLon),this}latLonToWorldPoint(t){const e=o.project(t);return n.vec2.sub(e.raw,e.raw,this.origin.raw),e}static project(t){return a.GeographyConverter.latLonToWorldPoint(t)}static unproject(t){return a.GeographyConverter.worldPointToLatLon(t)}worldPointToLatLon(t){const e=t.clone();return n.vec2.add(e.raw,e.raw,this.origin.raw),o.unproject(e)}get layers(){return this._layers}}e.Core=o},762:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FrustumCulling=void 0;const n=r(659);e.FrustumCulling=class{constructor(){this.prjViewMat=n.mat4.create(),this.nX=n.vec4.create(),this.pX=n.vec4.create(),this.nY=n.vec4.create(),this.pY=n.vec4.create(),this.nZ=n.vec4.create(),this.pZ=n.vec4.create()}update(t,e){n.mat4.mul(this.prjViewMat,t,e),this.nX[0]=this.prjViewMat[3]+this.prjViewMat[0],this.nX[1]=this.prjViewMat[7]+this.prjViewMat[4],this.nX[2]=this.prjViewMat[11]+this.prjViewMat[8],this.nX[3]=this.prjViewMat[15]+this.prjViewMat[12],this.pX[0]=this.prjViewMat[3]-this.prjViewMat[0],this.pX[1]=this.prjViewMat[7]-this.prjViewMat[4],this.pX[2]=this.prjViewMat[11]-this.prjViewMat[8],this.pX[3]=this.prjViewMat[15]-this.prjViewMat[12],this.nY[0]=this.prjViewMat[3]+this.prjViewMat[1],this.nY[1]=this.prjViewMat[7]+this.prjViewMat[5],this.nY[2]=this.prjViewMat[11]+this.prjViewMat[9],this.nY[3]=this.prjViewMat[15]+this.prjViewMat[13],this.pY[0]=this.prjViewMat[3]-this.prjViewMat[1],this.pY[1]=this.prjViewMat[7]-this.prjViewMat[5],this.pY[2]=this.prjViewMat[11]-this.prjViewMat[9],this.pY[3]=this.prjViewMat[15]-this.prjViewMat[13],this.nZ[0]=this.prjViewMat[3]+this.prjViewMat[2],this.nZ[1]=this.prjViewMat[7]+this.prjViewMat[6],this.nZ[2]=this.prjViewMat[11]+this.prjViewMat[10],this.nZ[3]=this.prjViewMat[15]+this.prjViewMat[14],this.pZ[0]=this.prjViewMat[3]-this.prjViewMat[2],this.pZ[1]=this.prjViewMat[7]-this.prjViewMat[6],this.pZ[2]=this.prjViewMat[11]-this.prjViewMat[10],this.pZ[3]=this.prjViewMat[15]-this.prjViewMat[14]}testAABB(t,e,r,n,i,a){return this.nX[0]*(this.nX[0]<0?t:n)+this.nX[1]*(this.nX[1]<0?e:i)+this.nX[2]*(this.nX[2]<0?r:a)>=-this.nX[3]&&this.pX[0]*(this.pX[0]<0?t:n)+this.pX[1]*(this.pX[1]<0?e:i)+this.pX[2]*(this.pX[2]<0?r:a)>=-this.pX[3]&&this.nY[0]*(this.nY[0]<0?t:n)+this.nY[1]*(this.nY[1]<0?e:i)+this.nY[2]*(this.nY[2]<0?r:a)>=-this.nY[3]&&this.pY[0]*(this.pY[0]<0?t:n)+this.pY[1]*(this.pY[1]<0?e:i)+this.pY[2]*(this.pY[2]<0?r:a)>=-this.pY[3]&&this.nZ[0]*(this.nZ[0]<0?t:n)+this.nZ[1]*(this.nZ[1]<0?e:i)+this.nZ[2]*(this.nZ[2]<0?r:a)>=-this.nZ[3]&&this.pZ[0]*(this.pZ[0]<0?t:n)+this.pZ[1]*(this.pZ[1]<0?e:i)+this.pZ[2]*(this.pZ[2]<0?r:a)>=-this.pZ[3]}}},565:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ITileLayer=void 0;const n=r(659),i=r(484),a=r(762);e.ITileLayer=class{constructor(t){this.core=t,this.tiles=[],this.frustumCulling=new a.FrustumCulling,this.minLOD=3,this.maxLOD=20}divide(t,e=this.maxLOD,r=1){let n,a,s,o=0;for(;o!=t.length;)n=t[o],a=n.quadcode,s=a.length,n.tilecode[2]!==this.maxLOD&&this.screenSpaceError(n,r)&&s<=e?(t.splice(o,1),["0","1","2","3"].forEach((e=>t.push(new i.ITile(a+e,this))))):o++}screenSpaceError(t,e){const r=this.camera,i=t.quadcode;if(i.length===this.maxLOD)return!1;if(i.length<this.minLOD)return!0;if(!this.tileInFrustum(t))return t.isVisible=!1,!1;const a=t.center,s=n.vec3.create();n.vec3.sub(s,[a[0],0,a[1]],r.position);const o=n.vec3.length(s);return 3*t.side/o>e}tileInFrustum(t){const e=t.center,r=t.side,n=e[0]-r/2,i=e[0]+r/2,a=e[1]-r/2,s=e[1]+r/2;return this.frustumCulling.testAABB(n,-1,a,i,1,s)}}},718:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NonRegularTileLayer=void 0;const n=r(565),i=r(484);class a extends n.ITileLayer{constructor(t){super(t)}update(t){this.camera=t,this.frustumCulling.update(t.projectionMatrix,t.viewMatrix),this.tiles=[],["0","1","2","3"].forEach((t=>this.tiles.push(new i.ITile(t,this)))),this.divide(this.tiles,this.maxLOD,1),this.tiles=this.tiles.sort(((t,e)=>t.quadcode.length-e.quadcode.length))}}e.NonRegularTileLayer=a},382:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GeographyConverter=void 0;const n=r(183),i=r(997);class a{static project(t){const e=Math.PI/180,r=a.MAX_LATITUDE,n=Math.max(Math.min(r,t.lat),-r),s=Math.sin(n*e);return new i.Point(a.R*t.lon*e,a.R*Math.log((1+s)/(1-s))/2)}static unproject(t){const e=180/Math.PI;return new n.LatLon((2*Math.atan(Math.exp(t.y/a.R))-Math.PI/2)*e,t.x*e/a.R)}static latLonToWorldPoint(t){const e=this.project(t);return e.y*=-1,e.x*=a.MULTIPLIER,e.y*=a.MULTIPLIER,e}static worldPointToLatLon(t){const e=new i.Point(t.x,-1*t.y);return e.x/=a.MULTIPLIER,e.y/=a.MULTIPLIER,this.unproject(e)}static quadcodeToTilecode(t){const e=t.length;let r=0,n=0;for(let i=e;i>0;i--){const a=1<<i-1,s=t.at(e-i);"1"===s&&(r|=a),"2"===s&&(n|=a),"3"===s&&(r|=a,n|=a)}return[r,n,e]}static tile2lon(t,e){return t/Math.pow(2,e)*360-180}static tile2lat(t,e){const r=Math.PI-2*Math.PI*t/Math.pow(2,e);return 180/Math.PI*Math.atan(.5*(Math.exp(r)-Math.exp(-r)))}static lonToTileX(t,e){return Math.floor((t+180)/360*(1<<e))}static latToTileY(t,e){const r=t*Math.PI/180;return Math.floor((1-Math.asinh(Math.tan(r))/Math.PI)/2*(1<<e))}}e.GeographyConverter=a,a.R=6378137,a.MAX_LATITUDE=85.0511287798,a.MULTIPLIER=.001},183:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LatLon=void 0;const n=r(659);e.LatLon=class{constructor(t,e){this.point=n.vec2.fromValues(t,e)}get lat(){return this.point[0]}set lat(t){this.point[0]=t}get lon(){return this.point[1]}set lon(t){this.point[1]=t}get raw(){return this.point}}},997:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;const n=r(659);class i{constructor(t,e){this.point=n.vec2.fromValues(t,e)}get x(){return this.point[0]}set x(t){this.point[0]=t}get y(){return this.point[1]}set y(t){this.point[1]=t}get raw(){return this.point}clone(){return new i(this.x,this.y)}}e.Point=i},484:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ITile=void 0;const n=r(183),i=r(382),a=r(997);class s{constructor(t,e){this._quadcode=t,this.layer=e,this._tilecode=i.GeographyConverter.quadcodeToTilecode(t),this.boundsLatLon=s.tileBoundsWGS84(this._tilecode),this._bounds=this.tileBoundsFromWGS84(this.boundsLatLon),this._center=s.boundsToCenter(this._bounds),this.centerLatLon=this.layer.core.worldPointToLatLon(new a.Point(this._center[0],this._center[1])),this.isVisible=!0}static tileBoundsWGS84(t){if(3!=t.length)throw RangeError("Tilecode array can't contain more or less three elements");return[i.GeographyConverter.tile2lon(t[0],t[2]),i.GeographyConverter.tile2lat(t[1]+1,t[2]),i.GeographyConverter.tile2lon(t[0]+1,t[2]),i.GeographyConverter.tile2lat(t[1],t[2])]}tileBoundsFromWGS84(t){if(4!=t.length)throw RangeError("boundsWGS84 array can't contain more or less four elements");const e=this.layer.core.latLonToWorldPoint(new n.LatLon(t[1],t[0])),r=this.layer.core.latLonToWorldPoint(new n.LatLon(t[3],t[2]));return[e.x,e.y,r.x,r.y]}static boundsToCenter(t){if(4!=t.length)throw RangeError("bounds array can't contain more or less four elements");return[t[0]+(t[2]-t[0])/2,t[1]+(t[3]-t[1])/2]}get quadcode(){return this._quadcode}get tilecode(){return this._tilecode}get bounds(){return this._bounds}get center(){return this._center}get side(){return this.bounds[1]-this.bounds[3]}}e.ITile=s},648:(t,e)=>{var r;Object.defineProperty(e,"__esModule",{value:!0}),e.RenderType=void 0,(r=e.RenderType||(e.RenderType={}))[r.WebGL=0]="WebGL",r[r.WebGPU=1]="WebGPU",e.default=class{constructor(t){this.canvas=t,this.canvasDimension=[0,0,1],this.canvasSamples=4}updateCanvas(){const t=this.canvas.clientWidth,e=this.canvas.clientHeight;return(t!==this.canvasDimension[0]||e!==this.canvasDimension[1])&&(this.canvasDimension=[t,e,1],this.canvas.width=this.canvasDimension[0],this.canvas.height=this.canvasDimension[1],!0)}}},929:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0,e.Scene=class{constructor(){this._models=[]}update(){}destroy(){}add(t){this._models.push(t)}get models(){return this._models}}},28:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IMeshAdapter=void 0,e.IMeshAdapter=class{}},959:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IModelAdapter=void 0,e.IModelAdapter=class{constructor(t){this._general=t}get general(){return this._general}}},623:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IPipeline=void 0,e.IPipeline=class{}},245:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IWebGPUPipelineMaterialLogic=e.IPipelineMaterialLogic=void 0;class r{}e.IPipelineMaterialLogic=r,e.IWebGPUPipelineMaterialLogic=class extends r{}},954:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ITextureAdapter=void 0,e.ITextureAdapter=class{}},468:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh=void 0,e.Mesh=class{constructor(){this._attributeBuffers=[]}declareAttributeBuffer(t,e,r){this._attributeBuffers.push({index:t,data:e,elementsForVtx:r})}declareIndexBuffer(t){this._indexesBuffer=t,this._indexesBufferLength=t.length}get attributeBuffers(){return this._attributeBuffers}get indexesBuffer(){return this._indexesBuffer}get indexesBufferLength(){return this._indexesBufferLength}}},630:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;const n=r(468),i=r(659);e.Model=class{constructor(){this._mesh=new n.Mesh,this._specifics=new Map,this._position=i.vec3.fromValues(0,0,0),this._rotation=i.vec3.fromValues(0,0,0),this._scale=i.vec3.fromValues(1,1,1)}get modelViewMatrix(){const t=i.mat4.create();return i.mat4.translate(t,i.mat4.create(),this._position),i.mat4.rotateX(t,t,this._rotation[0]),i.mat4.rotateY(t,t,this._rotation[1]),i.mat4.rotateZ(t,t,this._rotation[2]),i.mat4.scale(t,t,this._scale),t}get material(){return this._material}set material(t){t.model=this,this._material=t}get mesh(){return this._mesh}set mesh(t){t.model=this,this._mesh=t}get specifics(){return this._specifics}get modelViewMatrixBytes(){return new Float32Array(this.modelViewMatrix)}get position(){return this._position}set position(t){this._position=t}get scale(){return this._scale}set scale(t){this._scale=t}get rotation(){return this._rotation}set rotation(t){this._rotation=t}}},259:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function s(t){try{u(n.next(t))}catch(t){a(t)}}function o(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,o)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=void 0,e.Texture=class{constructor(t=null){null!=t&&this.loadUrl(t)}loadUrl(t){this.loadPromise=new Promise((e=>{this.loadAsync(t).then((()=>{e()}))}))}loadAsync(t){return r(this,void 0,void 0,(function*(){const e=yield fetch(t),r=yield e.blob();this._data=yield createImageBitmap(r)}))}get data(){return this._data}}},778:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ICamera=void 0;const n=r(659);e.ICamera=class{constructor(t,e){this.NEAR_DISTANCE=.1,this.FAR_DISTANCE=100,this.step=.5,this._position=t,this._target=e,this.up=[0,1,0],this._projectionMatrix=n.mat4.create(),this._viewMatrix=n.mat4.create(),window.addEventListener("keypress",(r=>{r.preventDefault(),"KeyW"===r.code&&(t[2]-=this.step,e[2]-=this.step),"KeyS"===r.code&&(t[2]+=this.step,e[2]+=this.step),"KeyA"===r.code&&(t[0]-=this.step,e[0]-=this.step),"KeyD"===r.code&&(t[0]+=this.step,e[0]+=this.step),"KeyZ"===r.code&&(t[1]+=this.step),"KeyX"===r.code&&(t[1]-=this.step)}))}get position(){return this._position}set position(t){this._position=t}set target(t){this._target=t}get projectionMatrix(){return this._projectionMatrix}get viewMatrix(){return this._viewMatrix}get combinedMatrix(){const t=n.mat4.create();return n.mat4.mul(t,this.projectionMatrix,this.viewMatrix),t}get projectionMatrixBytes(){return new Float32Array(this._projectionMatrix)}get viewMatrixBytes(){return new Float32Array(this._viewMatrix)}get combinedMatrixBytes(){return new Float32Array(this.combinedMatrix)}}},569:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PerspectiveCamera=void 0;const n=r(659),i=r(778);class a extends i.ICamera{update(t,e){const r=t/e;n.mat4.perspective(this.projectionMatrix,n.glMatrix.toRadian(45),r,this.NEAR_DISTANCE,this.FAR_DISTANCE),n.mat4.lookAt(this.viewMatrix,this._position,this._target,this.up)}}e.PerspectiveCamera=a},340:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BasicMaterial=void 0;const n=r(412),i=r(648),a=r(209),s=r(533);class o extends n.IMaterial{constructor(){super(),this._shaders=new Map,this._shaders.set(i.RenderType.WebGL,a.BasicPipeline.activate),this._shaders.set(i.RenderType.WebGPU,s.BasicPipeline.activate),this._tint=new Float32Array([0,0,0,1]),this._tintCoefficient=.5}get diffuse(){return this._diffuse}set diffuse(t){t.material=this,this._diffuse=t}get tint(){return this._tint}set tint(t){this._tint=t}get tintCoefficient(){return this._tintCoefficient}set tintCoefficient(t){this._tintCoefficient=t}}e.BasicMaterial=o},412:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IMaterial=void 0,e.IMaterial=class{get shaders(){return this._shaders}}},875:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLMesh=void 0;const n=r(28);class i extends n.IMeshAdapter{constructor(t,e){super(),this.renderer=t,this.ctx=t.ctx,this.attributeBuffers=new Map,this.restoreMeshFromDescription(e)}restoreMeshFromDescription(t){t.attributeBuffers.forEach((t=>{this.declareAttributeBuffer(t.index,t.data,t.elementsForVtx)})),this.declareIndexBuffer(t.indexesBuffer)}declareAttributeBuffer(t,e,r){this.ctx.bindVertexArray(this.vao),this.ctx.enableVertexAttribArray(t);const n=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,n),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,e,this.ctx.STATIC_DRAW),this.ctx.vertexAttribPointer(t,r,this.ctx.FLOAT,!1,0,0),this.attributeBuffers.set(t,n),this.ctx.bindVertexArray(null)}declareIndexBuffer(t){this.ctx.bindVertexArray(this.vao);const e=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,e),this.ctx.bufferData(this.ctx.ELEMENT_ARRAY_BUFFER,t,this.ctx.STATIC_DRAW),this.indicesBuffer=e,this.indicesBufferLength=t.length,this.ctx.bindVertexArray(null)}draw(){this.ctx.bindVertexArray(this.vao),this.ctx.drawElements(this.ctx.TRIANGLES,this.indicesBufferLength,this.ctx.UNSIGNED_INT,0),this.ctx.bindVertexArray(null)}}e.WebGLMesh=i},258:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLModelAdapter=void 0;const n=r(959),i=r(875);class a extends n.IModelAdapter{constructor(t,e){super(e),this.renderer=t,this.ctx=this.renderer.ctx,this._mesh=new i.WebGLMesh(t,e.mesh),this._material=e.material,this.invokePipeline(),this.logic=this._activePipeline.producePipelineMaterialLogic(this.renderer,this)}invokePipeline(){const t=this._material.shaders.get(this.renderer.TYPE).bind(this);this._activePipeline=t(this.renderer)}updateLocals(){this.luModelMatrixLoc=this.ctx.getUniformLocation(this._activePipeline.program,"modelMatrix"),this.ctx.uniformMatrix4fv(this.luModelMatrixLoc,!1,this.general.modelViewMatrixBytes)}draw(){this.invokePipeline(),this._activePipeline.activate(),this._activePipeline.update(),this.logic.updateLocals(),this.updateLocals(),this._mesh.draw()}get mesh(){return this._mesh}get material(){return this._material}get activePipeline(){return this._activePipeline}}e.WebGLModelAdapter=a},332:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,a){function s(t){try{u(n.next(t))}catch(t){a(t)}}function o(t){try{u(n.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,o)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=r(648),a=r(258);class s extends i.default{constructor(t){super(t),this.TYPE=i.RenderType.WebGL}init(){return n(this,void 0,void 0,(function*(){console.info("Instantiate WebGL renderer"),this.ctx=this.canvas.getContext("webgl2"),this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.enable(this.ctx.CULL_FACE),this.ctx.cullFace(this.ctx.FRONT)}))}startRender(){this.ctx.viewport(0,0,this.canvasDimension[0],this.canvasDimension[1]),this.ctx.scissor(0,0,this.canvasDimension[0],this.canvasDimension[1]),this.ctx.clearColor(Math.sin((new Date).getTime()/500),.5,1,1),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT)}endRender(){}render(t,e){this.updateCanvas(),this.startRender(),this.camera=e,e.update(this.canvasDimension[0],this.canvasDimension[1]),t.models.forEach((t=>{t.specifics.has(this.TYPE)||t.specifics.set(this.TYPE,new a.WebGLModelAdapter(this,t)),t.specifics.get(this.TYPE).draw()})),this.endRender(),this.camera=null}}e.default=s},76:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLTex=void 0;const n=r(954);class i extends n.ITextureAdapter{constructor(t,e){super(),this.renderer=t,this.ctx=t.ctx,this._general=e,this.createFromArrayBuffer(new Uint8Array([0,0,0,255])),e.loadPromise.then((()=>{this.createFromBitmap(this._general.data)}))}createFromArrayBuffer(t,e=1,r=1){const n=this.createDefaultTexture();this.ctx.activeTexture(this.ctx.TEXTURE0+0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,n),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,e,r,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),this._texture=n}createFromBitmap(t){const e=this.ctx.createTexture();this.ctx.activeTexture(this.ctx.TEXTURE0+0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,e),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),this._texture=e}destroy(){this.ctx.deleteTexture(this._texture)}reserveTexture(t,e){const r=this.createDefaultTexture();this.ctx.bindTexture(this.ctx.TEXTURE_2D,this._texture),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,t,e,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,null),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),this._texture=r}createDefaultTexture(){const t=this.ctx.createTexture();return this.ctx.bindTexture(this.ctx.TEXTURE_2D,t),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),t}get texture(){return this._texture}get general(){return this._general}}e.WebGLTex=i},111:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IWebGLPipeline=void 0;const n=r(623);class i extends n.IPipeline{constructor(t){super(),this.ctx=t.ctx,this.renderer=t}activate(){this.ctx.useProgram(this._program)}destroy(){this.ctx.deleteShader(this._program)}set program(t){this._program=t}get program(){return this._program}}e.IWebGLPipeline=i},209:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BasicPipelineMaterialLogic=e.BasicPipeline=void 0;const n=r(792),i=r(895),a=r(111),s=r(577),o=r(76),u=r(245);class h extends a.IWebGLPipeline{constructor(t){super(t);const e=new s.PipelineProgramBuilder(this.ctx);e.addVertexShader(n),e.addFragmentShader(i),this.program=e.build(),this.luPrjMatrixLoc=this.ctx.getUniformLocation(this.program,"prjMatrix"),this.luViewMatrixLoc=this.ctx.getUniformLocation(this.program,"viewMatrix")}static activate(t){return null==this.instance&&(this.instance=new h(t)),this.instance}update(){this.ctx.uniformMatrix4fv(this.luPrjMatrixLoc,!1,this.renderer.camera.projectionMatrixBytes),this.ctx.uniformMatrix4fv(this.luViewMatrixLoc,!1,this.renderer.camera.viewMatrixBytes)}producePipelineMaterialLogic(t,e){return new c(t,e)}}e.BasicPipeline=h,h.instance=null;class c extends u.IPipelineMaterialLogic{constructor(t,e){super(),this.ctx=t.ctx,this.renderer=t,this.model=e,this.material=this.model.material,this.tint=this.material.tint,this.tintCoefficient=this.material.tintCoefficient,this.diffuseTexture=new o.WebGLTex(t,this.material.diffuse);const r=this.model.activePipeline;this.luTintArrayLoc=this.renderer.ctx.getUniformLocation(r.program,"tintArray"),this.luTintCoefficientLoc=this.renderer.ctx.getUniformLocation(r.program,"tintCoefficient"),this.luDiffuseLoc=this.renderer.ctx.getUniformLocation(r.program,"diffuse")}updateLocals(){this.tint!=this.material.tint&&(this.tint=this.material.tint),this.tintCoefficient!=this.material.tintCoefficient&&(this.tintCoefficient=this.material.tintCoefficient),this.diffuseTexture.general!=this.material.diffuse&&(this.diffuseTexture=new o.WebGLTex(this.renderer,this.material.diffuse)),this.ctx.uniform4fv(this.luTintArrayLoc,this.tint),this.ctx.uniform1f(this.luTintCoefficientLoc,this.tintCoefficient),this.ctx.activeTexture(this.ctx.TEXTURE0+0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.diffuseTexture.texture),this.ctx.uniform1i(this.luDiffuseLoc,0)}}e.BasicPipelineMaterialLogic=c},577:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PipelineProgramBuilder=void 0,e.PipelineProgramBuilder=class{constructor(t){this.ctx=t}produceShader(t,e){const r=this.ctx.createShader(e);if(this.ctx.shaderSource(r,t),this.ctx.compileShader(r),!this.ctx.getShaderParameter(r,this.ctx.COMPILE_STATUS))throw new Error(this.ctx.getShaderInfoLog(r));return r}addVertexShader(t){this.vertexShader=this.produceShader(t,this.ctx.VERTEX_SHADER)}addFragmentShader(t){this.fragmentShader=this.produceShader(t,this.ctx.FRAGMENT_SHADER)}build(){const t=this.ctx.createProgram();if(this.ctx.attachShader(t,this.vertexShader),this.ctx.attachShader(t,this.fragmentShader),this.ctx.linkProgram(t),!this.ctx.getProgramParameter(t,this.ctx.LINK_STATUS))throw new Error(this.ctx.getProgramInfoLog(t));return this.ctx.detachShader(t,this.vertexShader),this.ctx.detachShader(t,this.fragmentShader),this.ctx.deleteShader(this.vertexShader),this.ctx.deleteShader(this.fragmentShader),t}}},62:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WebGPUTex=void 0;const n=r(954);class i extends n.ITextureAdapter{constructor(t,e){super(),this.renderer=t,this._general=e,this._sampler=this.renderer.device.createSampler({magFilter:"linear",minFilter:"linear"}),this.createFromArrayBuffer(new Uint8Array([0,0,0,255])),e.loadPromise.then((()=>{this.createFromBitmap(this._general.data)}))}createFromArrayBuffer(t,e=1,r=1){void 0!==this._texture&&this._texture.destroy(),this._texture=this.renderer.device.createTexture({size:{width:e,height:r},dimension:"2d",format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),this.renderer.queue.writeTexture({texture:this._texture},t,{offset:0},[e,r])}createFromBitmap(t){void 0!==this._texture&&this.texture.destroy(),this._texture=this.renderer.device.createTexture({size:{width:t.width,height:t.height},dimension:"2d",format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),this.renderer.queue.copyExternalImageToTexture({source:t},{texture:this._texture},[t.width,t.height])}destroy(){this._texture.destroy()}reserveTexture(t,e){this._texture.destroy(),this._texture=this.renderer.device.createTexture({size:[t,e],sampleCount:1,dimension:"2d",format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT})}get general(){return this._general}get texture(){return this._texture}get sampler(){return this._sampler}}e.WebGPUTex=i},50:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IWebGPUPipeline=void 0;const n=r(623);class i extends n.IPipeline{constructor(t){super(),this.renderer=t}activate(){this.renderer.passEncoder.setPipeline(this.pipeline)}destroy(){}combineBindUniforms(t){if(!this.globalUniforms)throw"Global uniforms stands undefined!";return this.globalUniforms.concat(t)}requestBindGroup(t){return this.renderer.device.createBindGroup({layout:this.uniformBindGroupLayout,entries:this.combineBindUniforms(t)})}set pipeline(t){this._pipeline=t}get pipeline(){return this._pipeline}}e.IWebGPUPipeline=i},533:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BasicPipelineMaterialLogic=e.BasicPipeline=void 0;const n=r(96),i=r(417),a=r(50),s=r(47),o=r(245),u=r(62);class h extends a.IWebGPUPipeline{constructor(t){super(t),this.guProjMatrixBuffer=(0,s.reserveBuffer)(this.renderer,64,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.guViewMatrixBuffer=(0,s.reserveBuffer)(this.renderer,64,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.createBindGroupLayoutGlobals(),this.createBindGroup()}static activate(t){return null==this.instance&&(this.instance=new h(t)),this.instance}createBindGroupLayoutGlobals(){this.globalUniforms=[{binding:0,resource:{buffer:this.guProjMatrixBuffer}},{binding:1,resource:{buffer:this.guViewMatrixBuffer}}]}createBindGroup(){const t={module:this.renderer.device.createShaderModule({code:n}),entryPoint:"main",buffers:[{attributes:[{shaderLocation:0,offset:0,format:"float32x3"}],arrayStride:12,stepMode:"vertex"},{attributes:[{shaderLocation:1,offset:0,format:"float32x2"}],arrayStride:8,stepMode:"vertex"}]},e={module:this.renderer.device.createShaderModule({code:i}),entryPoint:"main",targets:[{format:"rgba8unorm"}]};this.uniformBindGroupLayout=this.renderer.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:4,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:5,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:6,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]});const r=this.renderer.device.createPipelineLayout({bindGroupLayouts:[this.uniformBindGroupLayout]});this.pipeline=this.renderer.device.createRenderPipeline({vertex:t,fragment:e,primitive:{frontFace:"cw",cullMode:"none",topology:"triangle-list"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less-equal",format:"depth24plus-stencil8"},layout:r,multisample:{count:4}})}update(){this.renderer.queue.writeBuffer(this.guProjMatrixBuffer,0,this.renderer.camera.projectionMatrixBytes),this.renderer.queue.writeBuffer(this.guViewMatrixBuffer,0,this.renderer.camera.viewMatrixBytes)}producePipelineMaterialLogic(t,e){return new c(t,e)}}e.BasicPipeline=h,h.instance=null;class c extends o.IWebGPUPipelineMaterialLogic{constructor(t,e){super(),this.renderer=t,this.luTintBuffer=(0,s.reserveBuffer)(this.renderer,16,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.luTintCoefficientLoc=(0,s.reserveBuffer)(this.renderer,16,GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST),this.model=e,this.material=this.model.material,this.diffuseTexture=new u.WebGPUTex(t,this.material.diffuse)}updateLocals(){this.tint!=this.material.tint&&(this.tint=this.material.tint),this.tintCoefficient!=this.material.tintCoefficient&&(this.tintCoefficient=this.material.tintCoefficient),this.diffuseTexture.general!=this.material.diffuse&&(this.diffuseTexture=new u.WebGPUTex(this.renderer,this.material.diffuse)),this.renderer.queue.writeBuffer(this.luTintBuffer,0,this.tint),this.renderer.queue.writeBuffer(this.luTintCoefficientLoc,0,new Float32Array([this.tintCoefficient,0,0,0]))}requestBindGroup(){return[{binding:3,resource:{buffer:this.luTintBuffer}},{binding:4,resource:{buffer:this.luTintCoefficientLoc}},{binding:5,resource:this.diffuseTexture.sampler},{binding:6,resource:this.diffuseTexture.texture.createView()}]}}e.BasicPipelineMaterialLogic=c},47:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.reserveBuffer=e.createBuffer=void 0,e.createBuffer=(t,e,r)=>{const n={size:e.byteLength+3&-4,usage:r,mappedAtCreation:!0},i=t.device.createBuffer(n);return(e instanceof Uint32Array?new Uint32Array(i.getMappedRange()):new Float32Array(i.getMappedRange())).set(e),i.unmap(),i},e.reserveBuffer=(t,e,r)=>{const n={size:e+3&-4,usage:r,mappedAtCreation:!1};return t.device.createBuffer(n)}},895:t=>{t.exports="#version 300 es\r\n\r\nprecision highp float;\r\n\r\nin vec2 pUvs;\r\n\r\nuniform mat4 prjMatrix;\r\nuniform mat4 modelMatrix;\r\nuniform mat4 viewMatrix;\r\n\r\nuniform vec4 tintArray;\r\nuniform float tintCoefficient;\r\nuniform sampler2D diffuse;\r\n\r\nout vec4 outColor;\r\n\r\nvoid main() {\r\n    vec4 vColor = texture(diffuse, vec2(pUvs.x, pUvs.y));\r\n    vColor = mix(vColor, tintArray, tintCoefficient);\r\n    outColor = vColor;\r\n}"},792:t=>{t.exports="#version 300 es\r\n\r\nlayout(location = 0) in vec3 inPos;\r\nlayout(location = 1) in vec2 inUvs;\r\n\r\nuniform mat4 prjMatrix;\r\nuniform mat4 modelMatrix;\r\nuniform mat4 viewMatrix;\r\n\r\nuniform vec4 tintArray;\r\n\r\nout vec2 pUvs;\r\n\r\nvoid main() {\r\n    gl_Position = prjMatrix * viewMatrix * modelMatrix * vec4(inPos, 1.0f);\r\n    pUvs = inUvs;\r\n}"},417:t=>{t.exports="struct UBO {\n    tintCoefficient: f32,\n}\n\n// globals\n// !none\n\n// local\n@group(0) @binding(3) var<uniform> tint: vec4<f32>;\n@group(0) @binding(4) var<uniform> ubo_in: UBO;\n\n// local: diffuse\n@group(0) @binding(5) var diffuseSampler: sampler;\n@group(0) @binding(6) var diffuseTexture: texture_2d<f32>;\n\n@fragment\nfn main(@location(0) inUvs: vec2<f32>) -> @location(0) vec4<f32> {\n    var diffuseColor = textureSample(diffuseTexture, diffuseSampler, inUvs);\n    return mix(diffuseColor, tint, ubo_in.tintCoefficient);\n}\n"},96:t=>{t.exports="// globals\n@group(0) @binding(0) var<uniform> projMatrix: mat4x4<f32>;\n@group(0) @binding(1) var<uniform> viewMatrix: mat4x4<f32>;\n\n// locals\n@group(0) @binding(2) var<uniform> modelMatrix: mat4x4<f32>;\n\nstruct VSOut {\n    @builtin(position) Position: vec4<f32>,\n    @location(0) uvs: vec2<f32>\n};\n\n@vertex\nfn main(@location(0) inPos: vec3<f32>, @location(1) inUvs: vec2<f32>) -> VSOut {\n    var vsOut: VSOut;\n\n    vsOut.Position = projMatrix * viewMatrix * modelMatrix * vec4<f32>(inPos, 1.0);\n    vsOut.uvs = inUvs;\n\n    return vsOut;\n}\n"}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const t=r(332),e=r(929),n=r(569),i=r(630),a=r(468),s=r(259),o=r(340),u=r(489),h=document.getElementById("gfx"),c=new t.default(h),l=new n.PerspectiveCamera([1,5,10],[0,0,0]),f=new e.Scene,d=new Float32Array([-1,0,1,1,0,1,1,0,-1,-1,0,-1]),M=new Float32Array([0,1,1,1,1,0,0,0]),p=new Uint32Array([0,1,2,0,2,3,2,1,0,3,2,0]),m=new a.Mesh;m.declareAttributeBuffer(0,d,3),m.declareAttributeBuffer(1,M,2),m.declareIndexBuffer(p);const v=new u.Core;v.setWorldPosition(46.9641,142.7285);let x=!1;const b=()=>{window.requestAnimationFrame(b),c.render(f,l),v.update(l),x||(v.layers.forEach((t=>{t.tiles.forEach((t=>{const e=new i.Model;e.mesh=m,e.position=[t.center[0],0,t.center[1]],e.scale=[t.side/2,1,t.side/2];const r=new o.BasicMaterial;r.diffuse=new s.Texture(`https://tile.openstreetmap.org/${t.tilecode[2]}/${t.tilecode[0]}/${t.tilecode[1]}.png`),r.tint=new Float32Array([Math.random(),Math.random(),Math.random(),1]),r.tintCoefficient=.5,e.material=r,f.add(e)}))})),x=!0)};c.init().then(b)})()})();